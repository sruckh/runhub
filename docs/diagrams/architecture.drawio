<mxGraphModel>
  <root>
    <mxCell id="0"/>
    <mxCell id="1" parent="0"/>

    <!-- Title -->
    <mxCell id="2" value="iMontage RunningHub â€” System Architecture" style="text;html=1;fontSize=18;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#1e293b;" vertex="1" parent="1">
      <mxGeometry x="100" y="10" width="600" height="30" as="geometry"/>
    </mxCell>

    <!-- User -->
    <mxCell id="10" value="User / Browser" style="shape=actor;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=12;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="350" y="50" width="100" height="50" as="geometry"/>
    </mxCell>

    <!-- SvelteKit App Container -->
    <mxCell id="20" value="SvelteKit Application (Node.js / Docker)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=13;fontStyle=1;verticalAlign=top;align=center;spacingTop=5;dashed=0;container=1;" vertex="1" parent="1">
      <mxGeometry x="60" y="140" width="680" height="200" as="geometry"/>
    </mxCell>

    <!-- Frontend Page -->
    <mxCell id="21" value="&lt;b&gt;+page.svelte&lt;/b&gt;&lt;br&gt;Web UI&lt;br&gt;&lt;i&gt;Form / Results / Modal&lt;/i&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="20">
      <mxGeometry x="20" y="40" width="160" height="70" as="geometry"/>
    </mxCell>

    <!-- API: /api/generate -->
    <mxCell id="22" value="&lt;b&gt;/api/generate&lt;/b&gt;&lt;br&gt;Prompt Engineering&lt;br&gt;&amp; Job Submission" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="20">
      <mxGeometry x="200" y="40" width="155" height="70" as="geometry"/>
    </mxCell>

    <!-- API: /api/check -->
    <mxCell id="23" value="&lt;b&gt;/api/check&lt;/b&gt;&lt;br&gt;Task Polling&lt;br&gt;&amp; Image Download" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="20">
      <mxGeometry x="375" y="40" width="145" height="70" as="geometry"/>
    </mxCell>

    <!-- API: /api/images -->
    <mxCell id="24" value="&lt;b&gt;/api/images/[...path]&lt;/b&gt;&lt;br&gt;Static Image Serving" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="20">
      <mxGeometry x="540" y="40" width="120" height="70" as="geometry"/>
    </mxCell>

    <!-- Mounted Volume -->
    <mxCell id="25" value="&lt;b&gt;/mount&lt;/b&gt;&lt;br&gt;Volume (outputs/)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="20">
      <mxGeometry x="440" y="130" width="130" height="55" as="geometry"/>
    </mxCell>

    <!-- External: Gemini API -->
    <mxCell id="30" value="&lt;b&gt;Google Gemini API&lt;/b&gt;&lt;br&gt;gemini-3-pro-preview&lt;br&gt;&lt;i&gt;Prompt Generation&lt;/i&gt;" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="80" y="400" width="210" height="100" as="geometry"/>
    </mxCell>

    <!-- External: RunningHub API -->
    <mxCell id="31" value="&lt;b&gt;RunningHub API&lt;/b&gt;&lt;br&gt;FLUX.1-dev LoRA&lt;br&gt;&lt;i&gt;Image Generation&lt;/i&gt;" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="500" y="400" width="210" height="100" as="geometry"/>
    </mxCell>

    <!-- Arrows: User to Frontend -->
    <mxCell id="40" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;startArrow=classic;strokeColor=#666666;exitX=0.5;exitY=1;entryX=0.12;entryY=0;" edge="1" parent="1" source="10" target="20">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="40l" value="HTTP" style="edgeLabel;html=1;fontSize=9;fontColor=#666666;" vertex="1" connectable="0" parent="40">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- Frontend to /api/generate -->
    <mxCell id="41" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#2563eb;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="20" source="21" target="22">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="41l" value="POST" style="edgeLabel;html=1;fontSize=9;fontColor=#2563eb;" vertex="1" connectable="0" parent="41">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- Frontend to /api/check -->
    <mxCell id="42" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#2563eb;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="20" source="21" target="23">
      <mxGeometry relative="1" as="geometry">
        <Array as="points"><mxPoint x="195" y="93"/><mxPoint x="195" y="75"/></Array>
      </mxGeometry>
    </mxCell>
    <mxCell id="42l" value="Poll 5s" style="edgeLabel;html=1;fontSize=9;fontColor=#2563eb;" vertex="1" connectable="0" parent="42">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- Frontend to /api/images -->
    <mxCell id="43" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#2563eb;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="20" source="21" target="24">
      <mxGeometry relative="1" as="geometry">
        <Array as="points"><mxPoint x="190" y="55"/><mxPoint x="190" y="25"/><mxPoint x="530" y="25"/><mxPoint x="530" y="75"/></Array>
      </mxGeometry>
    </mxCell>
    <mxCell id="43l" value="GET img" style="edgeLabel;html=1;fontSize=9;fontColor=#2563eb;" vertex="1" connectable="0" parent="43">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- /api/check to Volume -->
    <mxCell id="44" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#82b366;exitX=0.5;exitY=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="20" source="23" target="25">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="44l" value="Save PNG" style="edgeLabel;html=1;fontSize=9;fontColor=#82b366;" vertex="1" connectable="0" parent="44">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- /api/images to Volume -->
    <mxCell id="45" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#82b366;exitX=0.5;exitY=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="20" source="24" target="25">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="45l" value="Read" style="edgeLabel;html=1;fontSize=9;fontColor=#82b366;" vertex="1" connectable="0" parent="45">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- /api/generate to Gemini -->
    <mxCell id="50" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#d79b00;exitX=0.38;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="20" target="30">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="50l" value="Generate Prompt" style="edgeLabel;html=1;fontSize=9;fontColor=#d79b00;" vertex="1" connectable="0" parent="50">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- /api/generate to RunningHub (submit) -->
    <mxCell id="51" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#d79b00;exitX=0.7;exitY=1;exitDx=0;exitDy=0;entryX=0.3;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="20" target="31">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="51l" value="Submit Job" style="edgeLabel;html=1;fontSize=9;fontColor=#d79b00;" vertex="1" connectable="0" parent="51">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

    <!-- /api/check to RunningHub (poll) -->
    <mxCell id="52" style="edgeStyle=orthogonalEdgeStyle;curved=1;endArrow=classic;strokeColor=#d79b00;dashed=1;exitX=0.82;exitY=1;exitDx=0;exitDy=0;entryX=0.7;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="20" target="31">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="52l" value="Query Status &amp; Download" style="edgeLabel;html=1;fontSize=9;fontColor=#d79b00;" vertex="1" connectable="0" parent="52">
      <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
    </mxCell>

  </root>
</mxGraphModel>